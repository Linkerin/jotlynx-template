---
import { getCollection } from 'astro:content';
import type { GetStaticPathsOptions } from 'astro';

import getSortedArticles from '@/utils/getSortedArticles';
import MainLayout from '@/layouts/MainLayout.astro';
import config from '@/website.config.json';
import ContainerLayout from '@/layouts/ContainerLayout.astro';
import Pagination from '@/components/Pagination.astro';
import ArticlesList from '@/components/ArticlesList.astro';

export const getStaticPaths = async ({ paginate }: GetStaticPathsOptions) => {
  const articles = await getCollection('articles');
  return paginate(getSortedArticles(articles), {
    pageSize: config.itemsPerPage
  });
};

const { page } = Astro.props;
---

<MainLayout>
  <ContainerLayout>
    <section>
      <div>
        <h1>Articles</h1>

        <ArticlesList articles={page.data} />
      </div>

      <footer>
        <Pagination page={page} />
      </footer>
    </section>
  </ContainerLayout>
</MainLayout>

<style>
  section {
    display: flex;
    flex-direction: column;
    gap: var(--jl-spacing-md);
    justify-content: space-between;
    height: 100%;
  }

  h1 {
    color: var(--jl-color-text);
  }

  footer {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    position: sticky;
    bottom: 0;
    padding-block-end: var(--jl-spacing-xxl);
    width: 100%;
  }
</style>
